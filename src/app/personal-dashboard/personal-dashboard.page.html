<style>
  /* Task box styling */
  .task-box:hover {
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
  }

  /* Task ID styling */
  .task-jobID {
    font-size: 12px;
    font-weight: 600;
  }

  /* Bubble container styling */
  .bubble-container {
    padding: 5px 0;
    display: flex;
    flex-wrap: wrap; /* Ensure bubbles wrap */
    gap: 5px; /* Space between bubbles */
  }

  /* Task date styling */
  .task-date {
    font-size: 11px;
    text-align: center;
    color: gray;
  }

  .task-box {
    border: 1px solid lightgray;
    padding: 5px 5px; /* Reduced padding for a more compact layout */
    border-radius: 10px;
    margin-bottom: 10px; /* Less margin between task boxes */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .row {
    margin-bottom: 5px; /* Reduce spacing between rows */
  }

  .task-label {
    font-size: 12px; /* Slightly smaller font */
    font-weight: bold;
    border-radius: 15px;
    padding: 3px 8px; /* Compact padding */
    color: white;
  }

  /* Task label colors */
  .label-po {
    background-color: rgb(148, 92, 203); /* PO - Purple */
  }

  .label-do {
    background-color: rgb(86, 193, 255); /* DO - Blue */
  }

  .label-pu {
    background-color: rgb(253, 238, 149); /* PU - Yellow */
  }

  .label-del {
    background-color: rgb(85, 203, 107); /* DEL - Green */
  }

  .label-co {
    background-color: #E8D3D1; /* DEL - Green */
  }

  .label-pre {
    background-color: rgb(238, 150, 62); /* DEL - Green */
  }

  .row{
    margin-top:0 !important;
    margin-bottom:0 !important;
  }

  .bubble-content {
    font-weight: bold;
    background-color: lightgray;
    padding: 3px 8px; /* Reduced padding for smaller bubbles */
    border-radius: 5px;
    font-size: 10px; /* Adjusted font size for better readability in compact mode */
    display: inline-block;
    margin-top:0 !important;
    margin-bottom:0 !important;
  }

  .truncated-text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px; /* Adjust the width as per your layout */
    display: inline-block;
  }
</style>
<app-common-header [pageSource]="'personal-dashboard'" [headerTitle]="'Personal Dashboard'"></app-common-header>

<ion-content class="ordelist">

  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- Date Filter -->
  <ion-row>
    <ion-col size="8">
      <ion-item lines="none">
        <h5 style="font-size: 13px; margin:0; color: #999; padding-top: 10px;">Job Date: <span style="font-size: 13px; color: black;">{{ filterDate }}</span></h5>
      </ion-item>
    </ion-col>
    <ion-col size="4">
      <ion-button (click)="is_show = !is_show" style="margin-top: 10px;">Change</ion-button>
    </ion-col>
    <div style="margin: 0 auto;" *ngIf="is_show == true" >
      <ion-datetime presentation="date" [(ngModel)]="filterDate" id="datetime" (ionChange)="filterTasks()"></ion-datetime>
    </div>
  </ion-row>

<!--  <ion-accordion-group>-->
<!--    <ion-accordion value="pending" class="ion-no-padding">-->
<!--      <ion-item slot="header" class="ion-no-padding ion-no-margin" mode="ios" lines="none"-->
<!--                style="margin-left: 15px;">-->
<!--        <div class="status">{{pending_count}}</div>-->
<!--        <ion-label>-->
<!--          <ion-row class="productorderlist">-->
<!--            <ion-col size="12" class="productdetail">-->
<!--              <div>-->
<!--                <h5 class="txt400" style="margin-top: 0;">Haven't Schedule Jobs</h5>-->
<!--                <br>-->
<!--                <br>-->
<!--              </div>-->
<!--            </ion-col>-->
<!--          </ion-row>-->
<!--        </ion-label>-->
<!--      </ion-item>-->

<!--      <ion-list slot="content">-->
<!--        <ion-item style="margin-left: 0 !important;margin-top: 0;border-top: 1px dashed #b4b4b4; margin-left: -5px !important;">-->
<!--          <ion-row class="productorderlist">-->
<!--            <ion-col size="12" class="productdetail" style="padding:0;">-->
<!--              <ion-button expand="block" (click)="openTaskAction()">Action</ion-button>-->
<!--              <div *ngFor="let task of TaskList;">-->
<!--                <ion-list *ngFor="let item of task.task_list" class="task-box" style="margin-top: 10px;">-->
<!--                  <ion-item lines="none">-->
<!--                    <ion-checkbox slot="start" [(ngModel)]="item.selected" (ionChange)="updateSelectedTasks(item, task.customer_data.name)"></ion-checkbox>-->
<!--                    <ion-label>-->
<!--                      {{item.job_type == '3'?'PO': item.job_type == '2'? 'DO':'CO'}}: {{task.customer_data.name}}-->
<!--                    </ion-label>-->
<!--                  </ion-item>-->

<!--                  <ion-item lines="none" class="row bubble-container" *ngIf="item.internal_remark">-->
<!--                    <ion-label class="bubble-content" *ngFor="let bubble of item.internal_remark">{{bubble}}</ion-label>-->
<!--                  </ion-item>-->

<!--                  <ion-item lines="none" class="task-date">-->
<!--                    <ion-label>-->
<!--                      {{item.created_date}}-->
<!--                    </ion-label>-->
<!--                  </ion-item>-->
<!--                </ion-list>-->
<!--              </div>-->
<!--            </ion-col>-->
<!--          </ion-row>-->
<!--        </ion-item>-->
<!--      </ion-list>-->
<!--    </ion-accordion>-->
<!--  </ion-accordion-group>-->

  <ion-accordion-group>
    <ion-accordion value="scheduled" class="ion-no-padding">
      <ion-item slot="header" class="ion-no-padding ion-no-margin" mode="ios" lines="none"
                style="margin-left: 15px;">
        <div class="status">{{scheduled_count}}</div>
        <ion-label>
          <ion-row class="productorderlist">
            <ion-col size="12" class="productdetail">
              <div>
                <h5 class="txt400" style="margin-top: 0;">Scheduled Jobs</h5>
                <h5  *ngIf="collaborator.length != 0" class="txt400" style="margin-top: 0;">Collaborators:</h5>
                <h5 class="txt400 row" style="margin-top: 0;" *ngFor="let item of collaborator">{{item}}</h5>
                <br *ngIf="collaborator.length == 0">
                <br *ngIf="collaborator.length == 0">
              </div>
            </ion-col>
          </ion-row>
        </ion-label>
      </ion-item>

      <ion-reorder-group slot="content" [disabled]="false" (ionItemReorder)="doReorder($event)">
        <div style="margin-left: 0 !important;margin-top: 0;border-top: 1px dashed #b4b4b4; margin-left: -5px !important;">
          <ion-button expand="block" (click)="openTaskActionAddCollaboratorModal()" style="margin-left: 10px; margin-right: 10px; font-size: 12px;">Collaborator</ion-button>
          <ion-button expand="block" (click)="saveUpdatedPriorities()" style="margin-left: 10px; margin-right: 10px; font-size: 12px;" *ngIf="filterDate >= todayDate">Confirm Schedule</ion-button>
          <ion-row>
            <ion-col size="4" *ngIf="filterDate == todayDate" >
              <ion-button expand="block" (click)="createCustomizeTask('Start Daily Job')" style="margin-left: 10px; margin-right: 10px; font-size: 12px;" [disabled]="is_start">Start Work</ion-button>
            </ion-col>
            <ion-col size="4" *ngIf="filterDate == todayDate" >
              <ion-button expand="block" (click)="createCustomizeTask('Eat')" style="margin-left: 10px; margin-right: 10px; font-size: 12px;">Eat</ion-button>
            </ion-col>
            <ion-col size="4" *ngIf="filterDate == todayDate" >
              <ion-button expand="block" (click)="createCustomizeTask('Complete Daily Job')" style="margin-left: 10px; margin-right: 10px; font-size: 12px;">End Work</ion-button>
            </ion-col>
          </ion-row>
        </div>
        <ion-list *ngFor="let item of completedTaskList" class="task-box" style="margin-top: 10px; margin-left: 10px; margin-right: 10px;">
          <ion-reorder slot="start" *ngIf="item.status != 2"></ion-reorder>
          <ion-item lines="none" (click)="taskAction(item)">
            <ion-grid>
              <ion-row class="align-items-center">
                <!-- Task label column -->
                <ion-col size="8" style="font-size: 12px;">
                  <ion-row class="align-items-center">
                    <!-- Job type labels -->
                    <ion-col size="4">
                      <ion-badge *ngIf="item.task_type == 'PO' && item.pre_order == '0'" class="task-label label-po">PO</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'PO' && item.pre_order == '1'" class="task-label label-pre">PRE</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'DO'" class="task-label label-do">DO</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'CO'" class="task-label label-co">CO</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'LO' && item.task_name == 'Logistic- PickUp'" class="task-label label-pu">PU</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'LO' && item.task_name == 'Logistic- Delivery'" class="task-label label-del">DEL</ion-badge>
                    </ion-col>
                    <!-- Customer name -->
                    <ion-col size="8">
                      <div class="truncated-text">
                        <b *ngIf="item.pre_order != '1'">{{ item.customer_name }}</b>
                        <b *ngIf="item.task_type == 'PO' && item.pre_order == '1'">{{ item.customer_name }}-{{item.serial}}</b>
                      </div>
                    </ion-col>
                  </ion-row>
                </ion-col>

                <!-- XAU amount column -->
                <ion-col size="4" class="ion-text-right" *ngIf="item.xau_outstanding && item.xau_outstanding != 0" style="font-size: 8px;">
                  <b>{{ item.xau_outstanding | number:'1.3-3' }} XAU</b>
                </ion-col>
              </ion-row>

              <!-- Bubble content for internal remarks -->
              <ion-row class="bubble-container">
                <ion-col size="12">
                  <ion-chip *ngIf="item.payment_method == 'Cash'">
                    <ion-label>ðŸ’°</ion-label>
                  </ion-chip>
                  <!-- Display remarks -->
                  <ion-chip *ngIf="item.remarks && item.remarks != '-'">
                    <ion-label>{{item.remarks}}</ion-label>
                  </ion-chip>
                  <!-- Display internal remarks -->
                  <ion-chip *ngFor="let bubble of item.internal_remark">
                    <ion-label>{{bubble}}</ion-label>
                  </ion-chip>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>
        </ion-list>
        <ion-reorder-group disabled="false" >
          <ion-list *ngFor="let item of scheduledTaskList" class="task-box" style="margin-top: 10px; margin-left: 10px; margin-right: 10px;">
            <ion-reorder slot="start" *ngIf="item.status != 2"></ion-reorder>
            <ion-item lines="none" (click)="taskAction(item)">
            <ion-grid>
              <ion-row class="align-items-center">
                <!-- Task label column -->
                <ion-col size="8" style="font-size: 12px;">
                  <ion-row class="align-items-center">
                    <!-- Job type labels -->
                    <ion-col size="4">
                      <ion-badge *ngIf="item.task_type == 'PO' && item.pre_order == '0'" class="task-label label-po">PO</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'PO' && item.pre_order == '1'" class="task-label label-pre">PRE</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'DO'" class="task-label label-do">DO</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'CO'" class="task-label label-co">CO</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'LO' && item.task_name == 'Logistic- PickUp'" class="task-label label-pu">PU</ion-badge>
                      <ion-badge *ngIf="item.task_type == 'LO' && item.task_name == 'Logistic- Delivery'" class="task-label label-del">DEL</ion-badge>
                    </ion-col>
                    <!-- Customer name -->
                    <ion-col size="8">
                      <div class="truncated-text">
                        <b *ngIf="item.pre_order != '1'">{{ item.customer_name }}</b>
                        <b *ngIf="item.task_type == 'PO' && item.pre_order == '1'">{{ item.customer_name }}-{{item.serial}}</b>
                      </div>
                    </ion-col>
                  </ion-row>
                </ion-col>

                <!-- XAU amount column -->
                <ion-col size="4" class="ion-text-right" *ngIf="item.xau_outstanding && item.xau_outstanding != 0" style="font-size: 8px;">
                  <b>{{ item.xau_outstanding | number:'1.3-3' }} XAU</b>
                </ion-col>
              </ion-row>

              <!-- Bubble content for internal remarks -->
              <ion-row class="bubble-container">
                <ion-col size="12">
                  <ion-chip *ngIf="item.payment_method == 'Cash'">
                    <ion-label>ðŸ’°</ion-label>
                  </ion-chip>
                  <!-- Display remarks -->
                  <ion-chip *ngIf="item.remarks && item.remarks != '-'">
                    <ion-label>{{item.remarks}}</ion-label>
                  </ion-chip>
                  <!-- Display internal remarks -->
                  <ion-chip *ngFor="let bubble of item.internal_remark">
                    <ion-label>{{bubble}}</ion-label>
                  </ion-chip>
                </ion-col>
              </ion-row>
            </ion-grid>
            </ion-item>
<!--            <div (click)="taskAction(item)">-->
<!--              <ion-item lines="none">-->
<!--                <ion-label *ngIf="item.task_type != 'CO' && item.task_type != 'LO'">-->
<!--                  <ion-row class="row">-->
<!--                    <ion-col size="8">-->
<!--                      <span>{{item.customer_name}}</span>-->
<!--                    </ion-col>-->
<!--                    <ion-col size="2">-->
<!--                      <span>{{item.task_type}}</span>-->
<!--                    </ion-col>-->
<!--                    <ion-col size="2">-->
<!--                      ({{item.relation_count}})-->
<!--                    </ion-col>-->
<!--                  </ion-row>-->
<!--                </ion-label>-->
<!--                <ion-label *ngIf="item.task_type == 'CO' || item.task_type == 'LO'">-->
<!--                  <ion-row class="row">-->
<!--                    <ion-col size="8">-->
<!--                      <span>{{item.customer_name}}</span>-->
<!--                    </ion-col>-->
<!--                    <ion-col size="4">-->
<!--                      <span>{{item.logistic_type}}</span>-->
<!--                    </ion-col>-->
<!--                  </ion-row>-->
<!--                </ion-label>-->
<!--                <ion-label *ngIf="item.task_type == 'CO'">-->
<!--                  {{item.task_type}}<span *ngIf="item.task_name">:</span> {{item.task_name}}-->
<!--                </ion-label>-->
<!--              </ion-item>-->
<!--              <ion-item lines="none" class="row bubble-container" *ngIf="item.xau && item.xau != 0">-->
<!--                <ion-label class="bubble-content">{{item.xau}} XAU</ion-label>-->
<!--              </ion-item>-->
<!--              <ion-item lines="none" class="row bubble-container" *ngIf="item.remarks && item.remarks != '-'">-->
<!--                <ion-label class="bubble-content">{{item.remarks}}</ion-label>-->
<!--              </ion-item>-->

<!--              <ion-item lines="none" class="row bubble-container" *ngIf="item.internal_remark">-->
<!--                <ion-label class="bubble-content" *ngFor="let bubble of item.internal_remark">{{bubble}}</ion-label>-->
<!--              </ion-item>-->

<!--&lt;!&ndash;              <ion-item lines="none" class="task-date">&ndash;&gt;-->
<!--&lt;!&ndash;                <ion-label>&ndash;&gt;-->
<!--&lt;!&ndash;                  {{item.job_date}}&ndash;&gt;-->
<!--&lt;!&ndash;                </ion-label>&ndash;&gt;-->
<!--&lt;!&ndash;              </ion-item>&ndash;&gt;-->
<!--            </div>-->
          </ion-list>
        </ion-reorder-group>
      </ion-reorder-group>
    </ion-accordion>

  </ion-accordion-group>

  <div class="spacer" style="height: 40px"></div>
</ion-content>

<mytab></mytab>
