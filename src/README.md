# PWGROUP-RIDER-PORTAL

# PWA
https://pwgroup-rider-app.web.app/login

# IOS ENTERPRISE USAGE
https://s3.amazonaws.com/pwgroup/PWRider.ipa
https://s3.amazonaws.com/pwgroup/icon57.png
https://s3.amazonaws.com/pwgroup/icon.png


# Jason Discovery
copy package.json
copy angular.json
copy ionic.config.json
copy tsconfig.app.json
npm install --legacy-peer-deps

## Installation
    ionic start PWGROUP-RIDER-PORTAL sidemenu

1. choose Angular
2. rename src folder to src_
3. git clone PWGROUP-RIDER-PORTAL.git to this location
4. rename PWGROUP-RIDER-PORTAL into src
5. relocate your github to this src folder, as the source of this project


# PWRider In House App
Android:
1ï¼‰https://s3.amazonaws.com/pwgroup/PWRider-v160.apk

0.0.166
1. Add Cdo module

0.0.165
1. Fix and improve the gold shipment detail page.

0.0.164
1. Fix Task Count

0.0.163
1. Debug upload button

0.0.162
1. Remove check permission camera

0.0.161
1. Switch to capacitor

0.0.160
1. Task Update

0.0.159
1. Gold Shipment Enhancement and assay report clock in

0.0.158
1. Gold Shipment Enhancement

0.0.157
1. Gold Shipment for MJO

0.0.155=6
1. Gold Shipment Debug and Enhancement

0.0.154
1. Gold Shipment Enhancement and Exchange Enhancement

0.0.153
1. Gold Shipment Exchange Part

0.0.152
1. TBC change request approval

0.0.151
1. Add Customer Name at Order Job and Pending Job Task PO

0.0.150
1. Debug TNG Image Upload Problem

0.0.149
1. Pending Job Debugging

0.0.148
1. Pending Job Enhancement

0.0.147
1. Jewel Bar Project enhancement

0.0.146
1. Jewel Bar Project and Image Format debug

0.0.145
1. Debug upload image problem

0.0.144
1. Debug upload image problem

0.0.143
1. Debug upload image problem

0.0.142
1. Debug upload image problem

0.0.141
1. Enhancement Apps and debug

0.0.139
1. Enhancement Apps

0.0.135
1. Enhancement Pending Job

0.0.134
1. Enhancement Apps

0.0.133
1. Pending Job UI Modify

0.0.132
1. Gold Shipment Clock In

0.0.131
1. Pending Job Enhancement

0.0.130
1. OTW Task and point collect

0.0.129
1. Logistic Task

0.0.128
1. Collaborator Relation for task

0.0.127
1. Modify Pending Job

0.0.126
1. Modify Customer List

0.0.125
1. Pending Job

0.0.124
1. Customer List

0.0.123
1. Change request enhancement 

0.0.122
1. Prevent the error of big.js calculation

0.0.121
1. Modify task for service adjustment assignee

0.0.120
1. Modify the calculation

0.0.119
1. Enable or disable for certain rider to bypass recipient details for COD Complete and Completed staus.
2. Resort the details.
3. Allow rider to add more photo without deleting the captured one.

0.0.118
1. Bullion and Logistic Inbox
2. Inbox Search Box
3. Inbox Filter Read/Unread

0.0.117
1. Modify inbox show approve or reject

0.0.116
1. fix XAU calculation problem

0.0.115
1. remove amount and add GRN ID

0.0.114
1. Change Math.floor to Math.trunc and debug

0.0.113
1. Remove limitation of barcode input

0.0.112
1. Remove no_round_up(Calculation fixed)

0.0.111
1. Scrap Bar / Nugget Small Changes

0.0.110
1. Cash Payment in Task & Collection

0.0.109
1. Scrap Bar / Nugget Bug Fixed

0.0.108
1. Scrap Bar / Nugget Configuration

0.0.107
1. Debug DO Image issue

nvm use v16
ionic cordova build ios

0.0.106
1. Upload DO image in Collection & PendingWeight

0.0.105
1. Senior Rider QC Confirmation for GRN

0.0.104
1. Add Water Mark When Upload Image

0.0.103
1. Pending Weight Photo will bring forward to Pending Test
2. Every Page item list will show underline when photo is exist
3. Support web upload function

0.0.102
1. solve photo jumping issue
2. Collection Job order show photo uploaded or not (underline)

0.0.101
1. Let Rider able to update PW Item List (from Pending Order and )

0.0.100
1. to detach poID on GRND

0.0.99
1. to debug upload photo error

0.0.98
1. all item should have poid

0.0.97
1. Solve Rounding XAU issue
2. Solve Added item doesnt have poID issue

0.0.96
1. To debug Delete Item
2. To double check all item code default
3. Pending TBC lack of back button
4. Pending Test Loading Bar


0.0.95
1. Enhancement of Item Selection
2. is_admin checking for rounding_XAU edit
3. Rounding_XAU should not auto calculate

0.0.93
1. Pending Reweight Modal issue

0.0.92
1. Pending Task 

0.0.91
1. Add/Update GRND Change Request

0.0.89
1. Debugging for submit GRN and PendingWeight

0.0.88
1. Show Round XAU in itemlist if above 0

0.0.87
1. Upload photo according to item
2. Update/delete item according to item

0.0.85
1. itemList able to be empty when TNG

0.0.84
1. GRN Flow update
2. PendingWeight
3. GRN Flow UI update

0.0.83
1. watermark
2. Pending Job Order Function Update

0.0.82
1. Order Job Details Enhancement
2. Customer supplier List Enhancement

0.0.80
1. ICON
2. Splash update
3. etc

0.0.79
1. Debugging for Order Job Count in homepage.

0.0.78
1. UI Changes for Pending Job
2. Notification sending to admin and rider.

0.0.77
1. Modify customer note (remark) in Order Job Detail
2. Multiple Image

0.0.76
1. Pending Order Function.
2. Sales Order / Purchase Order Reject Pending when assign rider.

0.0.73
1. Debugging for added item in GRN

0.0.72
1. According to Warehouse to split GRN
2. Enhance GRN Logic

0.0.71 (Dev Server)
1. mutiple image
2. TNG no need reset gram

0.0.69 (Dev Server)
0.0.68 (Dev Server)

0.0.67 (Dev Server)

0.0.66
1. Debug QC page

0.0.65
1. Delivery Details enhancement
2. Remove Pickup Job after rider scanned

0.0.64
1. Bullion Pending test enhancement

0.0.63
1. Delivery, Delivery Details, Pickup, and Job Log page enhancement.
2. Batch Scan

0.0.62
1. Bullion add test flow

0.0.61
1. PWB 1707 Excel file enhancement: Bullion enhancement

0.0.60
1. Bullion add geolocation
2. Bullion operation flow enhancement

0.0.59
1. Debug Delivery submission

0.0.58
1. Rider submit PO function

0.0.57
1. Remove modal image upload button

0.0.56
1. Bullion image upload

0.0.55
1. Inbox changed

0.0.54
1. Push Notification Enabled

0.0.53
1. Bullion Operation flow Enhancement

0.0.52
1. Debug scss

0.0.51
1. Debug scss

0.0.50
1. Final/COD Complete enhancement(3 add-ons)

0.0.49
1. Job Log History module enhancement
2. Job Log History search multiple value
3. Pickup/Delivery/JobLog show COD icon
4. Pickup/Delivery/JobLog show Urgent icon

0.0.48
1. Location Permission

0.0.47
1. Delete an account

0.0.46
1. Task Multiple image upload

0.0.45
1. Add rider task module

0.0.44
1. fixed pickup and delivery dialcode issue

0.043
1. Pending Reweight
2. Pending Check
3. GRN generation flow enhancement

0.042
1. Add job log history page

0.0.41
1. Punching Log View Detail

0.0.40
1. Debug clocking submit

0.0.39
1. Debug clocking take photo

0.0.38
1. Punched Log & Punching function

0.0.37
1. Merged Bullion
2. Rider and QC can add/delete item
3. Add receiver info in pick up detail(logistic)
4. Add sender info in delivery detail(logistic)

0.0.36
1. QC and Rider Enhancement

0.0.35
1. Merged Bullion

0.0.34
1. Enhancement GRN and QC
2. Add the view more, arrange order, show order number


0.0.30
1. middle scan section add whatsapp, waze, phone
2. If admin assign rider A, rider B go to scan will replace the job.
3. If status is COD completed, will do the function same like Completed.

0.0.29
1. take photo will change direction
2. pickup/delivery list show already completed job

0.0.28
1. completed multiple image

0.0.27
1. testing multiple image (phase 2)

0.0.26
1. testing multiple image

0.0.25
1. to fix imagepicker bug

0.0.24
1. debug

0.0.23
1. upload multiple image

0.0.22
1. add upload photo (QR code)

0.0.21
1. add COD amount

0.0.20
1. debug

0.0.19
1. remove item to pickup

0.0.18
1. debug

0.0.17
1. forgot password by OTP

0.0.16
1. debug

0.0.15
1. add total count
2. debug refresher

0.0.14
1. add scroll refresh

0.0.13
1. enhancement

0.0.12
1. debug

0.0.11
1. enhancement

0.0.10
1. search serial no
2. login by mobile

0.0.9
1. debug

0.0.8
1. allow change status

0.0.7
1. after login redirect to pickup

0.0.6
1. debug

0.0.5
1. DEBUG 

0.0.4
1. debug

0.0.3
1.debug

0.0.2
1. Modification

0.0.1
1. Initial
2. Login

# Starting
## to see got what error, build first
ionic build 

# Ionic initial Settings
npm install -g @ionic/cli native-run cordova-res

# ionic Plugin (If you need to ionic serve)
npm install @ionic/pwa-elements
npm install --save @ionic-native/status-bar@4
npm install @ionic-native/core@4 --save
npm i cordova-plugin-camera
npm i cordova-res
npm i rxjs-compat
npm install @ionic-native/android-permissions
npm install --save @ionic-native/push@4
npm install @ionic-native/device@4
npm install @ionic-native/native-page-transitions@4
npm install @ionic-native/camera@4 --save
npm install cordova-plugin-inappbrowser
npm install @ionic-native/in-app-browser@4
npm install phonegap-plugin-barcodescanner
npm install @ionic-native/barcode-scanner@4
npm install @ionic-native/image-picker@4

#geolocation 
ionic cordova plugin add cordova-plugin-geolocation
npm install @ionic-native/geolocation@4

# signature
npm install --save signature_pad

# to add Platform for Real Device Testing
ionic cordova platform add ios@5.1.1
ionic cordova platform add android@8.1.0

# Cordova Plugin (If you need to test on Real Device)
ionic cordova plugin add cordova-plugin-android-permissions
ionic cordova plugin add phonegap-plugin-push
ionic cordova plugin add cordova-plugin-device
ionic cordova plugin add com.telerik.plugins.nativepagetransitions
ionic cordova plugin add cordova-plugin-camera

# Android 10.1.1 fix error (app:compileDebugJavaWithJavac)
npm i jetifier
npm i cordova-plugin-androidx-adapter
npx jetifier

# config.xml

# Some problems were found with the configuration of task ':app:processReleaseGoogleServices' (type 'GoogleServicesTask').
<preference name="GradlePluginGoogleServicesEnabled" value="true" />
<preference name="GradlePluginGoogleServicesVersion" value="4.3.8" />
<preference name="AndroidXEnabled" value="true" />
<preference name="AndroidLaunchMode" value="singleTop" />


# Platform 



# ANDROID PUBLISH USAGE
1. cd /Users/iteatech/Documents/PWGROUP-RIDER-PORTAL
2. ionic cordova build --release android
3. cd platforms/android/ && ./gradlew bundle && cd ../../ && jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore important_key/my-release-key.keystore -storepass JASONTIAN platforms/android/app/build/outputs/bundle/release/app-release.aab alias_name 
4. 

# How to generate Keystore
keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000

# To Solve Cordova Resources ERROR: Something went wrong installing the "sharp" module
npm i cordova-res

# ios Push Key Test
## Dev
> openssl x509 -in aps_development.cer -inform der -out apsDev.pem
> openssl pkcs12 -nocerts -out apsDevKey.pem -in aps_dev.p12
> input the password: 1357qetu
> re-enter the PEM pass phrase: 1357qetu
> cat apsDev.pem apsDevKey.pem > ck_dev20210603.pem
openssl s_client -connect gateway.sandbox.push.apple.com:2195 -cert apsDev.pem -key apsDevKey.pem

## Production
> openssl x509 -in aps.cer -inform der -out aps.pem
> openssl pkcs12 -nocerts -out apsKey.pem -in aps.p12
> input the password: 1357qetu
> re-enter the PEM pass phrase: 1357qetu
> cat aps.pem apsKey.pem > ck_20210603.pem
openssl s_client -connect gateway.push.apple.com:2195 -cert aps.pem -key apsKey.pem


# New Archive CMD
# copy bundletool-all-1.8.2.jar to build folder
cd build
java -jar bundletool-all-1.8.2.jar build-apks --mode=universal --bundle=/Users/iteatech/Documents/PWGROUP-RIDER-PORTAL/platforms/android/app/build/outputs/bundle/release/app-release.aab --output=./PWRider-v018.apks --ks=../important_key/my-release-key.keystore --ks-pass=file:../important_key/my-passfile.txt --ks-key-alias=alias_name
mv PWRider-v018.apks PWRider-v018.zip
unzip PWRider-v018.zip
mv universal.apk PWRider-v018.apk
cd ..

# ISSUE: An unhandled exception occurred: Project target does not exist.
ng add @ionic/cordova-builders

# cordova-plugin-telerik-imagepicker cannot be added. <edit-config> changes in this plugin conflicts with <edit-config> changes in config.xml. Conflicts must be resolved before plugin can be added.
https://github.com/Telerik-Verified-Plugins/ImagePicker/issues/216


# ionic cordova plugin list 
com.telerik.plugins.nativepagetransitions 0.7.0 "Native Page Transitions"
cordova-plugin-android-permissions 1.1.3 "Permissions"
cordova-plugin-androidx-adapter 1.1.3 "cordova-plugin-androidx-adapter"
cordova-plugin-camera 6.0.0 "Camera"
cordova-plugin-device 2.0.2 "Device"
cordova-plugin-geolocation 4.1.0 "Geolocation"
cordova-plugin-ionic-keyboard 2.2.0 "cordova-plugin-ionic-keyboard"
cordova-plugin-ionic-webview 5.0.0 "cordova-plugin-ionic-webview"
cordova-plugin-splashscreen 5.0.2 "Splashscreen"
cordova-plugin-statusbar 2.4.2 "StatusBar"
cordova-plugin-telerik-imagepicker 2.3.3 "ImagePicker"
cordova-support-google-services 1.3.2 "cordova-support-google-services"
phonegap-plugin-barcodescanner 8.1.0 "BarcodeScanner"
phonegap-plugin-multidex 1.0.0 "Multidex"
phonegap-plugin-push 2.3.0 "PushPlugin"


# build ios only
ionic cordova build ios
nvm use 16.15.1


# Check List
## Order Job
list: collection-supplier
detail: grn
detail-api: appGetSupplierDetail
submit-api: appSubmitGRN
modal: modal-grn

## Pending Weight
list: weight
detail: weight-detail
detail-api: appGetPendingWeightGrnData
submit-api: appSubmitPendingWeightGrnData
modal: modal-weight

## Pending Test
list: test
detail: test-detail
detail-api: appGetPendingTestGrnData
submit-api: appSubmitPendingTestGrnData
modal: modal-test

## Pending Reweight
list: bullion-pending-reweight
detail: bullion-pending-reweight-detail
detail-api:  appGetPendingReweightGrnData
submit-api: appSubmitPendingReweightGrnData
modal: modal-pending-reweight

## Pending QC
list: bullion-pending-check
detail: bullion-pending-check-detail
detail-api: appGetPendingCheckGrnData
submit-api: appSubmitPendingCheckGrnData
modal: modal-qc


# PWA build
ionic build --aot
firebase deploy	
    
